# Mega-NeRF:Scalable Construction of Large-Scale NeRFs for Virtual Fly-Throughs
# Abstract
我们使用神经辐射场(nerf)构建交互式3D环境, 利用无人机大规模视觉收集跨建筑甚至多个城市街区的数据。

与单一对象场景(传统上评估nerf的场景)相比，我们的尺度提出了多个挑战，包括

(1)需要在不同的光照条件下建模成千上万的图像，而每种图像只能捕捉场景的一小部分;

(2)不可避免的大模型容量，使得在单个GPU上训练不可行;

(3)快速渲染的重大挑战，将使交互式飞行。

为了解决这些挑战，我们首先分析大规模场景的可见性统计数据，激发一个稀疏网络结构，其中参数专门用于场景的不同区域。

我们介绍了一种简单的几何聚类算法用于数据并行，该算法将训练图像(或像素)划分为不同的NeRF子模块，这些子模块可以并行训练。

我们在现有数据集(Quad 6k和UrbanScene3D)以及我们自己的无人机镜头上评估了我们的方法，将训练速度提高了3倍，PSNR提高了12%。

我们还在Mega-NeRF的基础上评估了最近的NeRF快速渲染器，并介绍了一种利用时间相干性的新方法

我们的技术比传统的NeRF渲染速度提高了40倍，同时PSNR质量保持在0.8 db以内，超过了现有的快速渲染器的保真度。

## Introduction
神经渲染技术的最新进展导致了在照片逼真的新视图合成方面的重大进展，这是许多VR和AR的先决条件。

特别是神经辐射场(nerf)[24]已经引起了极大的关注，产生了广泛的后续工作，改进了原始方法的各个方面。

### Scale.
简单地说，我们的工作探索了nerf的可伸缩性。

现有的绝大多数方法都是探索单一对象场景，通常是在室内或从合成数据中捕获的。

据我们所知，Tanks and Temples[17]是NeRF评估使用的最大数据集，平均占地463平方米。

在这项工作中，我们scale nerf以从无人机镜头中捕捉和交互式可视化城市规模的环境，这些镜头比迄今为止的任何数据集都要大几个数量级，每个场景从150,000平方米到超过1,300,000平方米。

### Search and Rescue.
作为一个激励的用例，考虑搜索和救援，无人机提供了一种廉价的方法来快速测量一个区域，并优先考虑有限的第一反应资源(例如，地面团队部署)。

由于电池寿命和带宽限制了在实时[6]中捕获足够详细的镜头的能力，收集的镜头通常被重建为支持事后分析[42]的2D“鸟瞰图”

我们想象的未来，神经渲染将这种分析提升到3D，使响应团队能够检查现场，就像他们实时驾驶无人机一样，其详细程度远远超出了经典的结构从运动(SfM)所能实现的。

### Challenges
在这种背景下，我们会遇到多重挑战。

首先，像搜索和救援这样的应用程序是时间敏感的。

根据国家搜索和救援计划[1]，“受伤幸存者的预期寿命在最初24小时内减少80%，而未受伤幸存者的生存机会在前3天后迅速减少。”

因此，在几个小时内训练出一个适合我们的模型的能力是非常有价值的。

其次，由于我们的数据集比之前评估的数据集要大几个数量级(表1)，为了确保高视觉保真度，必须显著增加模型容量，进一步增加训练时间.

最后，尽管交互式渲染对于我们捕捉的规模的飞行和探索很重要，但现有的实时NeRF渲染器要么依赖于将输出预制表为有限分辨率的结构，这种结构的伸缩性很差，显著降低了渲染性能，要么需要过多的预处理时间。

### Mega-NeRF.
为了解决这些问题，我们提出了Mega-NeRF，一个用于大规模训练的框架3D场景，支持交互式飞行。

我们首先分析大规模场景的可见性统计数据，如表1所示。

![image](https://user-images.githubusercontent.com/48575896/226861670-3bac4849-bce0-4386-8f36-9239cbb1ab64.png)

由于只有一小部分训练图像从任何特定的场景点可见，我们引入了一个稀疏网络结构，其中参数专门用于场景的不同区域。

我们介绍了一个简单的几何聚类算法，该算法将训练图像(或像素)划分为不同的NeRF子模块，这些子模块可以并行训练.

我们进一步利用渲染时的空间局部性来实现即时可视化技术，该技术允许交互式飞行.

### Prior art.
我们使用“多个”NeRF子模块的方法受到DeRF[28]和KiloNeRF[29]最近工作的启发，它们使用类似的见解来加速预训练NeRF的渲染。

我们证明了模块化对于训练是至关重要的，特别是当与智能策略相结合时，通过几何聚类将训练数据“分片”到适当的模块中。

### Contributions.
我们建议重新表述NeRF架构，sparsifies层以空间感知的方式连接，促进训练和渲染时间的效率提高。

然后，我们调整训练过程以利用空间局部性并以完全并行的方式训练模型子权重，从而使训练速度提高了3倍，同时超过了现有方法的重建质量。

与此同时，我们评估了现有的快速渲染方法与我们训练的Mega-NeRF模型，并提出了一种利用时间相干性的新方法。

我们的技术只需要最少的预处理，避免了其他渲染器的有限分辨率下降，并保持了高水平的视觉保真度。

我们还提出了一个新的大规模数据集，包含从无人机拍摄的超过10万平方米的工业园区附近地形中收集的数千张高清图像。
